=======================================================================================
include stackworker_win.h and see

=======================================================================================
simple usage:

int report_to_console(unsigned int code, struct _EXCEPTION_POINTERS* ep)
{	
	// Generate error report
	DWORD	process_id=::GetCurrentProcessId();
	muradin::dbg::Win32Handle process(::OpenProcess( PROCESS_QUERY_INFORMATION |PROCESS_VM_READ,FALSE, process_id ));

	muradin::dbg::ModuleFileEnumerator mod_em(NULL);
	int sys_error=0;
	bool good=mod_em.enum_proc_modules(process.get(),process_id,sys_error);

	muradin::dbg::StackWalker sw(NULL,::GetCurrentProcessId(),::GetCurrentProcess());
	sw.get_callstacks(GetCurrentThread(),ep->ContextRecord);
	// Execute exception handler
	return EXCEPTION_EXECUTE_HANDLER;
}

void	bug_here(const TCHAR* msg,int n)
{
	__try
	{
		/// some bug code...
	}
	__except(report_to_console(GetExceptionCode(), GetExceptionInformation()))
	{    
		///....
	}
}